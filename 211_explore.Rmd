---
title: '211'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r read data}
library(tidyverse)
library(readxl)


# read in metadate for easy reference
metadata_plot <- read_excel("data_scripts/BLEA_LUNI_metadata.xlsx", sheet = 1)
metadata_idnv <- read_excel("data_scripts/BLEA_LUNI_metadata.xlsx", sheet = 2)


### read in yearly data ####

### 2016 data is wonky (different columns, and values w/in columns.. & has the multiple seeding starts)
nipomo2016 <- read_csv("data_scripts\nipomo2016.csv")
nipomo2016 <- nipomo2016[!apply(is.na(nipomo2016) | nipomo2016 == "", 1, all),]
nipomo2016$year <- "2016"


nipomo2017 <- read_csv("data_scripts/nipomolupine2017.csv")
nipomo2017 <- nipomo2017[!apply(is.na(nipomo2017) | nipomo2017 == "", 1, all),] # remove blank rows
nipomo2017$year <- "2017"


nipomo2018 <- read_csv("data_scripts/nipomolupine2018.csv")
nipomo2018 <- nipomo2018[!apply(is.na(nipomo2018) | nipomo2018== "", 1, all),]
nipomo2018$year <- "2018"


nipomo2019 <- read_csv("data_scripts/nipomolupine2019.csv")
nipomo2019 <- nipomo2019[!apply(is.na(nipomo2019) | nipomo2019 == "", 1, all),]
nipomo2019$year <- "2019"


yearlydata <-read_csv("data_scripts/nipomo5years.csv")
yearlydata$current.year <- as.factor(as.character(yearlydata$current.year))



#### bind all together ####
bind_17_18 <- bind_rows(nipomo2017, nipomo2018)
all_data <- bind_rows(bind_17_18, nipomo2019)
all_data$year <- as.factor(all_data$year)
```


```{r general trend}

### count the number of individuals over time
pop_trend <- all_data %>% 
  group_by(year) %>% 
  summarise(
    count = length(unique(id))
  )

plot(pop_trend, main = "indviduals over time")


```

```{r germination}
### number of germinates over time
ggplot(yearlydata, aes(current.year, germination)) +
  geom_boxplot() + 
  labs(
    title = "# germinants per year across all plots"
  )

### germ ~ bank
ggplot(yearlydata, aes(bank, germination)) +
  geom_smooth(method = "lm") +
  geom_point(aes(color = current.year)) +
  labs(title = "germination as function of seedbank")

#### germ ~ slop/aspect + cage

ggplot(yearlydata, aes(current.year, germination)) +
  geom_boxplot(aes(color = cage)) +
  facet_wrap(~Slope) + 
  labs(
    title = "# germinants per year across plot, by slope"
  )

ggplot(yearlydata, aes(current.year, germination)) +
  geom_boxplot(aes(color = cage)) +
  facet_wrap(~Aspect) + 
  labs(
    title = "# germinants per year across plot, by aspect"
  )
```

























